{"version":3,"sources":["./src/app/modules/cart/components/cart-items/cart-items.component.html","./src/app/helpers/payment.helper.ts","./src/app/models/orderModels/cartModel.ts","./src/app/modules/cart/cart-routing.module.ts","./src/app/modules/cart/cart.module.ts","./src/app/modules/cart/components/cart-items/cart-items.component.css","./src/app/modules/cart/components/cart-items/cart-items.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,soBAAukB,yBAAyB,6BAA6B,2BAA2B,6BAA6B,eAAe,6BAA6B,6BAA6B,0ZAA0Z,gCAAgC,2wB;;;;;;;;;;;;;;;;;ACA5pC;AAG3C,IAAa,aAAa,GAA1B,MAAa,aAAa;IACtB,UAAU;QACN,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,eAAe,CAAC,EAAE;YAClD,IAAI,CAAC,GAAG,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAChD,CAAC,CAAC,EAAE,GAAG,eAAe,CAAC;YACvB,CAAC,CAAC,IAAI,GAAG,iBAAiB,CAAC;YAC3B,CAAC,CAAC,GAAG,GAAG,yCAAyC,CAAC;YAClD,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;SACvC;IACL,CAAC;CACJ;AAVY,aAAa;IADzB,gEAAU,CAAC,EAAE,UAAU,EAAE,MAAM,EAAE,CAAC;GACtB,aAAa,CAUzB;AAVyB;;;;;;;;;;;;;;;;;ACAnB,MAAM,SAAS;IAKlB;QACI,IAAI,CAAC,kBAAkB,GAAC,EAAE,CAAC;QAC3B,IAAI,CAAC,UAAU,GAAC,CAAC,CAAC;IACtB,CAAC;CACJ;;;;;;;;;;;;;;;;;;;;;ACZwC;AACc;AAC8C;AAC1B;AAG3E,MAAM,MAAM,GAAW,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,SAAS,EAAE,kHAAkB,EAAE,WAAW,EAAC,CAAC,wFAAmB,CAAC,EAAE,CAAC,CAAC;AAMjH,IAAa,iBAAiB,GAA9B,MAAa,iBAAiB;CAAI;AAArB,iBAAiB;IAJ7B,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;KACxB,CAAC;GACW,iBAAiB,CAAI;AAAJ;;;;;;;;;;;;;;;;;;;;;ACZW;AACM;AAEW;AACwB;AAUlF,IAAa,UAAU,GAAvB,MAAa,UAAU;CAAI;AAAd,UAAU;IAPtB,8DAAQ,CAAC;QACR,YAAY,EAAE,CAAC,8FAAkB,CAAC;QAClC,OAAO,EAAE;YACP,4DAAY;YACZ,sEAAiB;SAClB;KACF,CAAC;GACW,UAAU,CAAI;AAAJ;;;;;;;;;;;;;ACdvB;AAAe,6GAA8C,uL;;;;;;;;;;;;;;;;;;;;;ACAX;AACa;AACL;AACI;AAGG;AASjE,IAAa,kBAAkB,GAA/B,MAAa,kBAAkB;IAI7B,YAAoB,aAA4B,EAAU,YAA0B;QAAhE,kBAAa,GAAb,aAAa,CAAe;QAAU,iBAAY,GAAZ,YAAY,CAAc;QAFpF,qBAAgB,GAAY,IAAI,CAAC;QAG/B,IAAI,CAAC,QAAQ,GAAC,IAAI,8EAAS,EAAE,CAAC;IAChC,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;IAED,gBAAgB;QACd,MAAM,SAAS,GAAoB,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;QAC5E,IAAI,CAAC,SAAS,EAAE;YACd,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;YAC9B,OAAO;SACR;QACD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;QAC7B,MAAM,SAAS,GAAc,IAAI,8EAAS,EAAE,CAAC;QAC7C,SAAS,CAAC,cAAc,GAAG,SAAS,CAAC;QACrC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,SAAS,CAAC,CAAC,IAAe,EAAE,EAAE;YACrE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,QAAQ,CAAC,cAAc,GAAG,SAAS,CAAC;QAC3C,CAAC,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,YAA+B;QACpC,IAAI,SAAS,GAAoB,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;QAC1E,SAAS,CAAC,OAAO,CAAC,CAAC,KAAoB,EAAE,KAAa,EAAE,EAAE;YACxD,IAAI,KAAK,CAAC,gBAAgB,KAAK,YAAY,CAAC,gBAAgB,EAAE;gBAC5D,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aAC5B;QACH,CAAC,CAAC,CAAC;QACH,YAAY,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC;QACxD,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;IAGD,GAAG,CAAC,MAAM;QACR,IAAI,CAAC,aAAa,CAAC,UAAU,EAAE,CAAC;QAChC,MAAM,WAAW,GAAmB,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC;QACpF,MAAM,OAAO,GAAS,MAAO,CAAC,cAAc,CAAC,SAAS,CAAC;YACrD,GAAG,EAAE,wEAAW,CAAC,cAAc;YAC/B,MAAM,EAAE,MAAM;YACd,KAAK,EAAE,CAAC,KAAoC,EAAE,EAAE;gBAC9C,MAAM,WAAW,GAAqB;oBACpC,MAAM,EAAE,WAAW,CAAC,EAAE;oBACtB,WAAW,EAAE,KAAK,CAAC,KAAK;oBACxB,WAAW,EAAE,KAAK,CAAC,EAAE;oBACrB,cAAc,EAAE,IAAI,CAAC,QAAQ,CAAC,cAAc;iBAC7C,CAAC;gBACF,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,SAAS,CAAC,CAAC,OAAO,EAAE,EAAE;oBACnE,IAAI,CAAC,SAAS,EAAE,CAAC;gBACnB,CAAC,CAAC,CAAC;YACL,CAAC;SACF,CAAC,CAAC;QAEH,OAAO,CAAC,IAAI,CAAC;YACX,IAAI,EAAE,iBAAiB;YACvB,WAAW,EAAE,EAAE;YACf,MAAM,EAAE,MAAM,GAAG,GAAG;SACrB,CAAC,CAAC;IACL,CAAC;IAED,YAAY;QACV,MAAM,QAAQ,GACZ,CAAC,EAAE,gBAAgB,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE;YACrC,EAAE,gBAAgB,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE;YACpC,EAAE,gBAAgB,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE;YACpC,EAAE,gBAAgB,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE;YACpC,EAAE,gBAAgB,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC;QACxC,YAAY,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;QACvD,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;IACD,SAAS;QACP,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QAChC,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;CAEF;;YA5EoC,4EAAa;YAAwB,2EAAY;;AAJzE,kBAAkB;IAN9B,+DAAS,CAAC;QACT,QAAQ,EAAE,gBAAgB;QAC1B,0PAA0C;QAE1C,SAAS,EAAE,CAAC,2EAAY,CAAC;;KAC1B,CAAC;GACW,kBAAkB,CAgF9B;AAhF8B","file":"src-app-modules-cart-cart-module-es2015.js","sourcesContent":["export default \"<div class=\\\"container\\\" *ngIf=\\\"isAnyItemsInCart\\\">\\n    <h3>Checkout</h3>\\n    <table class=\\\"table table-hover\\\">\\n        <thead class=\\\"thead-dark\\\">\\n            <tr>\\n                <th scope=\\\"col\\\">Product</th>\\n                <th scope=\\\"col\\\">Unit price</th>\\n                <th scope=\\\"col\\\">Qty</th>\\n                <th scope=\\\"col\\\">Order amount</th>\\n                <th></th>\\n            </tr>\\n        </thead>\\n        <tbody>\\n            <tr *ngFor=\\\"let item of checkout.checkoutItemModels\\\" class=\\\"table-secondary\\\">\\n                <th scope=\\\"row\\\">{{item.printedEditionName}}</th>\\n                <td>{{item.unitPrice.toFixed(2)}}</td>\\n                <td>{{item.quantity}}</td>\\n                <td>{{item.orderAmount.toFixed(2)}}</td>\\n                <td>\\n                    <button class=\\\"btn btn-sm btn-danger\\\" (click)=\\\"remove(item)\\\">\\n                        -\\n                    </button>\\n                </td>\\n            </tr>\\n        </tbody>\\n    </table>\\n    <div class=\\\"row d-flex justify-content-end\\\">\\n        <div class=\\\"col-6 d-flex align-items-center justify-content-start\\\">\\n            <h4>Total price: {{checkout.totalPrice.toFixed(2)}}</h4>\\n        </div>\\n        <div class=\\\"col-3 d-flex align-items-center justify-content-end\\\">\\n            <button class=\\\"btn btn-success\\\" (click)=\\\"pay(checkout.totalPrice)\\\">\\n                Buy now\\n            </button>\\n        </div>\\n    </div>\\n</div>\\n<div class=\\\"container d-flex justify-content-center\\\" *ngIf=\\\"!isAnyItemsInCart\\\">\\n    <h3>There is no any items in cart. You can go to <a [routerLink]=\\\"'/printededition'\\\">catalog</a> and choose some books</h3>\\n</div>\\n<div class=\\\"container btn-group btn-block justify-content-center d-flex\\\">\\n    <div class=\\\"btn btn-primary \\\" (click)=\\\"addTestItems()\\\">\\n        Add test data to table\\n    </div>\\n    <div class=\\\"btn btn-danger \\\" (click)=\\\"clearCart()\\\">\\n        Clear cart\\n    </div>\\n</div>\"","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class PaymentHelper {\r\n    loadStripe() {\r\n        if (!window.document.getElementById('stripe-script')) {\r\n            var s = window.document.createElement(\"script\");\r\n            s.id = \"stripe-script\";\r\n            s.type = \"text/javascript\";\r\n            s.src = \"https://checkout.stripe.com/checkout.js\";\r\n            window.document.body.appendChild(s);\r\n        }\r\n    }\r\n}","import { CartItemModel } from 'src/app/models/orderModels/cartItemModel';\r\nimport { CheckoutItemModel } from 'src/app/models/orderModels/checkoutItemModel';\r\n\r\nexport class CartModel {\r\n    cartItemModels: CartItemModel[];\r\n    checkoutItemModels:CheckoutItemModel[]\r\n    totalPrice: number;\r\n\r\n    constructor(){\r\n        this.checkoutItemModels=[];\r\n        this.totalPrice=0;\r\n    }\r\n}","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { CartItemsComponent } from 'src/app/modules/cart/components/cart-items/cart-items.component';\nimport { AuthenticationGuard } from 'src/app/helpers/authentication.guard';\n\n\nconst routes: Routes = [{ path: 'cartitems', component: CartItemsComponent, canActivate:[AuthenticationGuard] }];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class CartRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { CartRoutingModule } from './cart-routing.module';\nimport { CartItemsComponent } from './components/cart-items/cart-items.component';\n\n\n@NgModule({\n  declarations: [CartItemsComponent],\n  imports: [\n    CommonModule,\n    CartRoutingModule\n  ]\n})\nexport class CartModule { }\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZHVsZXMvY2FydC9jb21wb25lbnRzL2NhcnQtaXRlbXMvY2FydC1pdGVtcy5jb21wb25lbnQuY3NzIn0= */\"","import { Component, OnInit } from '@angular/core';\nimport { PaymentHelper } from 'src/app/helpers/payment.helper';\nimport { environment } from 'src/environments/environment'\nimport { OrderService } from 'src/app/services/order.service';\nimport { PaymentDataModel } from 'src/app/models/orderModels/paymentDataModel';\nimport { CartItemModel } from 'src/app/models/orderModels/cartItemModel';\nimport { CartModel } from 'src/app/models/orderModels/cartModel';\nimport { CheckoutItemModel } from 'src/app/models/orderModels/checkoutItemModel';\n\n@Component({\n  selector: 'app-cart-items',\n  templateUrl: './cart-items.component.html',\n  styleUrls: ['./cart-items.component.css'],\n  providers: [OrderService]\n})\nexport class CartItemsComponent implements OnInit {\n\n  isAnyItemsInCart: boolean = true;\n  checkout: CartModel;\n  constructor(private paymentHelper: PaymentHelper, private orderService: OrderService) {\n    this.checkout=new CartModel();\n  }\n\n  ngOnInit() {\n    this.getCartItemsList();\n  }\n\n  getCartItemsList() {\n    const cartItems: CartItemModel[] = JSON.parse(localStorage.getItem(\"cart\"));\n    if (!cartItems) {\n      this.isAnyItemsInCart = false;\n      return;\n    }\n    this.isAnyItemsInCart = true;\n    const cartModel: CartModel = new CartModel();\n    cartModel.cartItemModels = cartItems;\n    this.orderService.getCheckout(cartModel).subscribe((data: CartModel) => {\n      this.checkout = data;\n      this.checkout.cartItemModels = cartItems;\n    })\n  }\n\n  remove(checkoutItem: CheckoutItemModel) {\n    let cartItems: CartItemModel[] = JSON.parse(localStorage.getItem(\"cart\"));\n    cartItems.forEach((value: CartItemModel, index: number) => {\n      if (value.printedEditionId === checkoutItem.printedEditionId) {\n        cartItems.splice(index, 1);\n      }\n    });\n    localStorage.setItem(\"cart\", JSON.stringify(cartItems));\n    this.getCartItemsList();\n  }\n\n\n  pay(amount) {\n    this.paymentHelper.loadStripe();\n    const currentUser: { id: number } = JSON.parse(localStorage.getItem(\"currentUser\"));\n    const handler = (<any>window).StripeCheckout.configure({\n      key: environment.publishableKey,\n      locale: 'auto',\n      token: (token: { id: string, email: string }) => {\n        const paymentData: PaymentDataModel = {\n          userId: currentUser.id,\n          stripeEmail: token.email,\n          stripeToken: token.id,\n          cartItemModels: this.checkout.cartItemModels\n        };\n        this.orderService.sendPaymentData(paymentData).subscribe((success) => {\n          this.clearCart();\n        });\n      }\n    });\n\n    handler.open({\n      name: 'Payment service',\n      description: '',\n      amount: amount * 100\n    });\n  }\n\n  addTestItems() {\n    const testData: CartItemModel[] =\n      [{ printedEditionId: 3, quantity: 2 },\n      { printedEditionId: 1, quantity: 4 },\n      { printedEditionId: 2, quantity: 5 },\n      { printedEditionId: 4, quantity: 1 },\n      { printedEditionId: 5, quantity: 2 }];\n    localStorage.setItem(\"cart\", JSON.stringify(testData));\n    this.getCartItemsList();\n  }\n  clearCart() {\n    localStorage.removeItem(\"cart\");\n    this.getCartItemsList();\n  }\n\n}\n"],"sourceRoot":"webpack:///"}