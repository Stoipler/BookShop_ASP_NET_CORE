{"version":3,"sources":["src/app/modules/cart/components/cart-items/cart-items.component.html","src/app/helpers/payment.helper.ts","src/app/models/orderModels/cartModel.ts","src/app/modules/cart/cart-routing.module.ts","src/app/modules/cart/cart.module.ts","src/app/modules/cart/components/cart-items/cart-items.component.css","src/app/modules/cart/components/cart-items/cart-items.component.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<div class=\\\"container\\\" *ngIf=\\\"isAnyItemsInCart\\\">\\n    <h3>Checkout</h3>\\n    <table class=\\\"table table-hover\\\">\\n        <thead class=\\\"thead-dark\\\">\\n            <tr>\\n                <th scope=\\\"col\\\">Product</th>\\n                <th scope=\\\"col\\\">Unit price</th>\\n                <th scope=\\\"col\\\">Qty</th>\\n                <th scope=\\\"col\\\">Order amount</th>\\n                <th></th>\\n            </tr>\\n        </thead>\\n        <tbody>\\n            <tr *ngFor=\\\"let item of checkout.checkoutItemModels\\\" class=\\\"table-secondary\\\">\\n                <th scope=\\\"row\\\">{{item.printedEditionName}}</th>\\n                <td>{{item.unitPrice.toFixed(2)}}</td>\\n                <td>{{item.quantity}}</td>\\n                <td>{{item.orderAmount.toFixed(2)}}</td>\\n                <td>\\n                    <button class=\\\"btn btn-sm btn-danger\\\" (click)=\\\"remove(item)\\\">\\n                        -\\n                    </button>\\n                </td>\\n            </tr>\\n        </tbody>\\n    </table>\\n    <div class=\\\"row d-flex justify-content-end\\\">\\n        <div class=\\\"col-6 d-flex align-items-center justify-content-start\\\">\\n            <h4>Total price: {{checkout.totalPrice.toFixed(2)}}</h4>\\n        </div>\\n        <div class=\\\"col-3 d-flex align-items-center justify-content-end\\\">\\n            <button class=\\\"btn btn-success\\\" (click)=\\\"pay(checkout.totalPrice)\\\">\\n                Buy now\\n            </button>\\n        </div>\\n    </div>\\n</div>\\n<div class=\\\"container d-flex justify-content-center\\\" *ngIf=\\\"!isAnyItemsInCart\\\">\\n    <h3>There is no any items in cart. You can go to <a [routerLink]=\\\"'/printededition'\\\">catalog</a> and choose some books</h3>\\n</div>\\n<div class=\\\"container btn-group btn-block justify-content-center d-flex\\\">\\n    <div class=\\\"btn btn-primary \\\" (click)=\\\"addTestItems()\\\">\\n        Add test data to table\\n    </div>\\n    <div class=\\\"btn btn-danger \\\" (click)=\\\"clearCart()\\\">\\n        Clear cart\\n    </div>\\n</div>\"","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class PaymentHelper {\r\n    loadStripe() {\r\n        if (!window.document.getElementById('stripe-script')) {\r\n            var s = window.document.createElement(\"script\");\r\n            s.id = \"stripe-script\";\r\n            s.type = \"text/javascript\";\r\n            s.src = \"https://checkout.stripe.com/checkout.js\";\r\n            window.document.body.appendChild(s);\r\n        }\r\n    }\r\n}","import { CartItemModel } from 'src/app/models/orderModels/cartItemModel';\r\nimport { CheckoutItemModel } from 'src/app/models/orderModels/checkoutItemModel';\r\n\r\nexport class CartModel {\r\n    cartItemModels: CartItemModel[];\r\n    checkoutItemModels:CheckoutItemModel[]\r\n    totalPrice: number;\r\n\r\n    constructor(){\r\n        this.checkoutItemModels=[];\r\n        this.totalPrice=0;\r\n    }\r\n}","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { CartItemsComponent } from 'src/app/modules/cart/components/cart-items/cart-items.component';\nimport { AuthenticationGuard } from 'src/app/helpers/authentication.guard';\n\n\nconst routes: Routes = [{ path: 'cartitems', component: CartItemsComponent, canActivate:[AuthenticationGuard] }];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class CartRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { CartRoutingModule } from './cart-routing.module';\nimport { CartItemsComponent } from './components/cart-items/cart-items.component';\n\n\n@NgModule({\n  declarations: [CartItemsComponent],\n  imports: [\n    CommonModule,\n    CartRoutingModule\n  ]\n})\nexport class CartModule { }\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZHVsZXMvY2FydC9jb21wb25lbnRzL2NhcnQtaXRlbXMvY2FydC1pdGVtcy5jb21wb25lbnQuY3NzIn0= */\"","import { Component, OnInit } from '@angular/core';\nimport { PaymentHelper } from 'src/app/helpers/payment.helper';\nimport { environment } from 'src/environments/environment'\nimport { OrderService } from 'src/app/services/order.service';\nimport { PaymentDataModel } from 'src/app/models/orderModels/paymentDataModel';\nimport { CartItemModel } from 'src/app/models/orderModels/cartItemModel';\nimport { CartModel } from 'src/app/models/orderModels/cartModel';\nimport { CheckoutItemModel } from 'src/app/models/orderModels/checkoutItemModel';\n\n@Component({\n  selector: 'app-cart-items',\n  templateUrl: './cart-items.component.html',\n  styleUrls: ['./cart-items.component.css'],\n  providers: [OrderService]\n})\nexport class CartItemsComponent implements OnInit {\n\n  isAnyItemsInCart: boolean = true;\n  checkout: CartModel;\n  constructor(private paymentHelper: PaymentHelper, private orderService: OrderService) {\n    this.checkout=new CartModel();\n  }\n\n  ngOnInit() {\n    this.getCartItemsList();\n  }\n\n  getCartItemsList() {\n    const cartItems: CartItemModel[] = JSON.parse(localStorage.getItem(\"cart\"));\n    if (!cartItems) {\n      this.isAnyItemsInCart = false;\n      return;\n    }\n    this.isAnyItemsInCart = true;\n    const cartModel: CartModel = new CartModel();\n    cartModel.cartItemModels = cartItems;\n    this.orderService.getCheckout(cartModel).subscribe((data: CartModel) => {\n      this.checkout = data;\n      this.checkout.cartItemModels = cartItems;\n    })\n  }\n\n  remove(checkoutItem: CheckoutItemModel) {\n    let cartItems: CartItemModel[] = JSON.parse(localStorage.getItem(\"cart\"));\n    cartItems.forEach((value: CartItemModel, index: number) => {\n      if (value.printedEditionId === checkoutItem.printedEditionId) {\n        cartItems.splice(index, 1);\n      }\n    });\n    localStorage.setItem(\"cart\", JSON.stringify(cartItems));\n    this.getCartItemsList();\n  }\n\n\n  pay(amount) {\n    this.paymentHelper.loadStripe();\n    const currentUser: { id: number } = JSON.parse(localStorage.getItem(\"currentUser\"));\n    const handler = (<any>window).StripeCheckout.configure({\n      key: environment.publishableKey,\n      locale: 'auto',\n      token: (token: { id: string, email: string }) => {\n        const paymentData: PaymentDataModel = {\n          userId: currentUser.id,\n          stripeEmail: token.email,\n          stripeToken: token.id,\n          cartItemModels: this.checkout.cartItemModels\n        };\n        this.orderService.sendPaymentData(paymentData).subscribe((success) => {\n          this.clearCart();\n        });\n      }\n    });\n\n    handler.open({\n      name: 'Payment service',\n      description: '',\n      amount: amount * 100\n    });\n  }\n\n  addTestItems() {\n    const testData: CartItemModel[] =\n      [{ printedEditionId: 3, quantity: 2 },\n      { printedEditionId: 1, quantity: 4 },\n      { printedEditionId: 2, quantity: 5 },\n      { printedEditionId: 4, quantity: 1 },\n      { printedEditionId: 5, quantity: 2 }];\n    localStorage.setItem(\"cart\", JSON.stringify(testData));\n    this.getCartItemsList();\n  }\n  clearCart() {\n    localStorage.removeItem(\"cart\");\n    this.getCartItemsList();\n  }\n\n}\n"],"sourceRoot":"webpack:///"}